/*
 Copyright (c) 2015, Ben Schulz
 License: BSD 3-clause (http://opensource.org/licenses/BSD-3-Clause)
*/
function f(c){return function(g){return g}(function(g,h){function c(b){var e=b.columns.displayed().filter(function(a){return!!a.property}),d=b.data.valueSelector;b.data.source.streamValues(function(a){return a.filteredBy(b.data.predicate).sortedBy(b.data.comparator)}).then(function(a){return a.map(function(a){return"<tr>"+e.map(function(b){return"<td>"+d(a[b.property])+"</td>"}).join("")+"</tr>"}).reduce(function(a,b){return a+b},"")}).then(function(a){a=['<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">  <head></head>  <body>    <table>      <thead>',
"        <tr>"+e.map(function(a){return"<th>"+a.label()+"</th>"}).join("")+"</tr>","      </thead>      <tbody>",a,"      </tbody>    </table>  </body></html>"].join("");(window.navigator.a?window.navigator.a.bind(window.navigator):function(a,b){var d=k.createObjectURL(a),c=l.createElement("a");c.href=d;c.a=b;var e=l.createEvent("MouseEvents");e.initEvent("click",!0,!0);c.dispatchEvent(e);window.setTimeout(function(){return k.revokeObjectURL(d)})})(new m([a],{type:"application/vnd.ms-excel;charset=utf-8"}),
"excel-export.xls")})}var l=window.document,m=window.Blob,k=window.URL;h.defineExtension("ko-grid-export",{b:["ko-grid-toolbar"],c:function(b){b.into("left-toolbar").insert(' <button class="ko-grid-toolbar-button ko-grid-excel-export">Excel Export</button> ')},a:function(b,e,d){d.rootElement.addEventListener("click",function(a){a.target.classList.contains("ko-grid-excel-export")&&c(d)})}});return h.declareExtensionAlias("export","ko-grid-export")}({},c))}
"function"===typeof define&&define.amd?define(["ko-grid","ko-data-source","ko-indexed-repeat","knockout"],f):window["ko-grid-export"]=f(window.ko.bindingHandlers.grid);
